function addlinks(e){return e=e.replace(/((https?|s?ftp|ssh)\:\/\/[^"\s\<\>]*[^.,;'">\:\s\<\>\)\]\!])/g,function(e){return'<a href="'+e+'" >'+e+"</a>"}),e=e.replace(/\B@([_a-z0-9]+)/gi,function(e){return'<a href="http://twitter.com/'+e.substring(1)+'" style="font-weight:lighter;" >'+e.charAt(0)+e.substring(1)+"</a>"})}function relative_time(e){var t=e.split(" "),e=t[1]+" "+t[2]+", "+t[5]+" "+t[3],n=Date.parse(e),a=arguments.length>1?arguments[1]:new Date,s=parseInt((a.getTime()-n)/1e3),i=e.substr(4,2)+" "+e.substr(0,3);return s+=60*a.getTimezoneOffset(),s<60?"1m":s<120?"1m":s<3600?parseInt(s/60).toString()+"m":s<7200?"1h":s<86400?parseInt(s/3600).toString()+"h":s<172800?i:i}function populateInstagram(e){e.find(".feed").instagram({userId:"327816113",accessToken:"327816113.1677ed0.572bac214e3c418a97c6773e591567aa",image_size:"thumbnail",show:12}).find(".spinner").addClass("hidden")}function sesStorage(){try{return"sessionStorage"in window&&null!==window.sessionStorage}catch(e){return!1}}!function(e){e.fn.instagram=function(t){function n(t,n){var a=t.images.thumbnail.url;"low_resolution"==l.image_size?a=t.images.low_resolution.url:"thumbnail"==l.image_size?a=t.images.thumbnail.url:"standard_resolution"==l.image_size&&(a=t.images.standard_resolution.url);var s=e("<img>").addClass("instagram-image").attr("src",a);return l.photoLink&&(s=e("<a>").attr("target","_blank").attr("href",t.link).append(s)),e("<div>").addClass("instagram-placeholder").attr("id","inst"+n).append(s)}function a(){return e("<div>").addClass("instagram-placeholder").attr("id","empty").append(e("<p>").html("No photos for this query"))}function s(){var t=r,n={};return null!=l.next_url?l.next_url:(null!=l.hash?t+="/tags/"+l.hash+"/media/recent":null!=l.search?(t+="/media/search",n.lat=l.search.lat,n.lng=l.search.lng,null!=l.search.max_timestamp&&(n.max_timestamp=l.search.max_timestamp),null!=l.search.min_timestamp&&(n.min_timestamp=l.search.min_timestamp),null!=l.search.distance&&(n.distance=l.search.distance)):t+=null!=l.userId?"/users/"+l.userId+"/media/recent":null!=l.locationId?"/locations/"+l.locationId+"/media/recent":"/media/popular",null!=l.accessToken&&(n.access_token=l.accessToken),null!=l.clientId&&(n.client_id=l.clientId),null!=l.minId&&(n.min_id=l.minId),null!=l.maxId&&(n.max_id=l.maxId),null!=l.show&&(n.count=l.show),t+="?"+e.param(n))}var i=this,r="https://api.instagram.com/v1",l={hash:null,userId:null,locationId:null,search:null,accessToken:null,clientId:null,show:null,onLoad:null,onComplete:null,maxId:null,minId:null,next_url:null,image_size:null,photoLink:!0};return t&&e.extend(l,t),null!=l.onLoad&&"function"==typeof l.onLoad&&l.onLoad(),e.ajax({type:"GET",dataType:"jsonp",cache:!1,url:s(),success:function(e){var t=void 0!==e.data?e.data.length:0,s=null!=l.show&&t>l.show?l.show:t;if(s>0)for(var r=0;s>r;r++)i.append(n(e.data[r],r));else i.append(a());null!=l.onComplete&&"function"==typeof l.onComplete&&l.onComplete(e.data,e),i.data("loaded",!0)}}),this}}(jQuery),function(){for(var e,t=function(){},n=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],a=n.length,s=window.console=window.console||{};a--;)e=n[a],s[e]||(s[e]=t)}(),!function(e){e.fn.droptab=function(t){function n(e,t,n){var a=n.parent().width();return e>a?("L"==t||""==t)&&("L"==t&&b.call(this),t="S",n.css("height",0).addClass(u).prev().css("display","block")):("S"==t||""==t)&&("S"==t&&b.call(this),t="L",n.css("height","auto").removeClass(u+" "+p).prev().removeClass(p).css("display","none")),t}function a(e,t,n,a){e.addClass(function(){return setTimeout(function(){e.empty().text(a).removeClass(n)},t),n})}function s(e,t,n){if(e.find("."+t).length>0){var a=e.find("."+t).find("a").text();return a}return n}var i=e.extend({breakWidth:"auto",selectBoxClass:"droptab-selector",selectCurrent:"droptab-select-current",selectButton:"droptab-select-button",smallMenuClass:"droptab-small-menu",menuClass:"droptab-menu",menuOpenClass:"open",activeClass:"active",hiddenMsgClass:"drop-tab-hidden",openMsg:"Choose",msgTransitionTime:250,autoClose:!1,droptabCallback:function(){},droptabSwitch:function(){}},t),r=this,l=i.breakWidth,o=i.selectBoxClass,d=i.selectCurrent,c=i.selectButton,u=i.smallMenuClass,m=i.menuClass,p=i.menuOpenClass,h=i.activeClass,g=i.hiddenMsgClass,f=i.openMsg,v=i.msgTransitionTime,C=i.autoClose,w=i.droptabCallback,b=i.droptabSwitch;this.addClass(m).before('<div class="'+o+'"><span class="'+d+'"></span><span class="'+c+'">Open Button</span></div>');var _=this.siblings("."+o),$=s(r,h,f);_.find("."+d).text($),"auto"==l&&(l=0,r.find("li").each(function(){l=l+e(this).outerWidth(!0)+1}));var x=n(l,"",r);_.find("."+c).on("click",function(){var t=e(this),n=e(this).siblings("."+d),i=0;e(this).parent().hasClass(p)?(t.parent().toggleClass(p),r.toggleClass(p).css("height",0),$=s(r,h,f),$&&a(n,v,g,$)):(r.find("li").each(function(){i+=e(this).outerHeight(!0)}).promise().done(function(){t.parent().toggleClass(p),r.css("height",i).toggleClass(p)}),n.text()!=f&&a(n,v,g,f))}),r.find("a").on("click",function(){e(this).closest("."+m).hasClass(u)&&1==C&&setTimeout(function(){_.find("."+c).trigger("click")},250)}),e(window).on("resize",function(){x=n(l,x,r)}),w.call(this)}}(jQuery),$(document).ready(function(){if($("nav ul").droptab({breakWidth:768,targetWidth:$("body"),openMsg:"Menu"}),$("#aap").length)var e=setTimeout(function(){var t=$("#aap").find("span");if(t.length){clearTimeout(e);var n=t.html();t.html(n.replace("<br>"," "))}},1e3);if($("#twfeed").length){var t=3,n=!1,a=!0,s=!0,i="";i+='<div id="loading-container"><img src="images/fancybox_loading.gif" width="32" height="32" alt="tweet loader" /></div>',$("#twitter-feed").html(i),$.getJSON("get-tweets.php",function(e){for(var i="",r=1,l=0;l<e.length;l++){var o=e[l].user.name,d=e[l].user.screen_name,c=e[l].user.profile_image_url_https.replace("normal","bigger"),u=e[l].text,m=!1,p=!1,h=e[l].id_str;"undefined"!=typeof e[l].retweeted_status&&(c=e[l].retweeted_status.user.profile_image_url_https.replace("normal","bigger"),o=e[l].retweeted_status.user.name,d=e[l].retweeted_status.user.screen_name,h=e[l].retweeted_status.id_str,m=!0),"@"==e[l].text.substr(0,1)&&(p=!0),(1==a||0==m&&0==a)&&(1==n||0==n&&0==p)&&e[l].text.length>1&&r<=t&&(1==s&&(u=addlinks(u)),i+='<div class="twt col-xs-12 col-md-4">',i+='<div class="row no-margin">',i+='<div class="col-xs-3 padding-0 tw-img">',i+='<img src="'+c+'"images/twitter-feed-icon.png" class="responsive-img-full" alt="'+d+'" />',i+="</div>",i+='<div class="col-xs-9 tw-body">',i+='<span class="at"><a href="https://twitter.com/'+d+'">@'+d+'</a></span> <span class="time">'+relative_time(e[l].created_at)+"</span>",i+="<p>"+u+"</p>",i+="</div>",i+="</div>",i+="</div>")}$("#twfeed > .row").html(i)})}if($("#instfeed").length){var r=$("#instfeed");sesStorage()?null===sessionStorage.getItem("instContent")||sessionStorage.getItem("instContent").length<1e3?(populateInstagram(r),setTimeout(function(){sessionStorage.setItem("instContent",$("#instfeed").html())},1e3)):$("#instfeed").empty().html(sessionStorage.getItem("instContent")):populateInstagram(r)}if($("#contact-form").length){var l=!1;$("#contact-form").on("submit",function(e){e.preventDefault(),$("[required]").each(function(){""==$(this).val()&&(l=!0)}),l||($("#contact-form").find(".button").addClass("hidden"),$("#contact-spinner").removeClass("hidden"),$.ajax({type:"POST",url:"contact-form.php",data:$("#contact-form .item").serializeArray(),success:function(e){$("#contact-form")[0].reset(),$("#contact-msg").addClass("green").html(e)},error:function(){$("#contact-msg").addClass("red").html("Uh oh, we ran into a problem sending your message.  Please try again later, or give us a call.")},complete:function(){$("#contact-spinner").fadeOut("fast",function(){$("#contact-msg").fadeIn("fast")})}}))})}$("#newsletter-form").length&&$("#newsletter-form").on("submit",function(e){$("#newsletter-button").addClass("hidden"),$("#newsletter-spinner").removeClass("hidden")})});